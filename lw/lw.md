# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 4.1. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤ —Ö—Ä–∞–Ω–µ–Ω–∏—è –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö

## –¢–∏—Ç—É–ª—å–Ω—ã–π –ª–∏—Å—Ç

**–î–∏—Å—Ü–∏–ø–ª–∏–Ω–∞:** –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö  
**–¢–µ–º–∞:** –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤ —Ö—Ä–∞–Ω–µ–Ω–∏—è –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö  
**–í–∞—Ä–∏–∞–Ω—Ç:** 3  

**–í—ã–ø–æ–ª–Ω–∏–ª–∞:** –ê—Ä–ª–∏–Ω—Å–∫–∞—è –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–∞ –í–∏–∫—Ç–æ—Ä–æ–≤–Ω–∞  
**–ü—Ä–æ–≤–µ—Ä–∏–ª:** –ë–æ—Å–µ–Ω–∫–æ –¢–∏–º—É—Ä –ú—É—Ä—Ç–∞–∑–æ–≤–∏—á  
**–ö—É—Ä—Å –æ–±—É—á–µ–Ω–∏—è:** 4  
**–§–æ—Ä–º–∞ –æ–±—É—á–µ–Ω–∏—è:** –æ—á–Ω–∞—è  

**–ò–Ω—Å—Ç–∏—Ç—É—Ç —Ü–∏—Ñ—Ä–æ–≤–æ–≥–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è**  
**–î–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∏, —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π**  
**–ú–æ—Å–∫–æ–≤—Å–∫–∏–π –≥–æ—Ä–æ–¥—Å–∫–æ–π –ø–µ–¥–∞–≥–æ–≥–∏—á–µ—Å–∫–∏–π —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç**  
**–ú–æ—Å–∫–≤–∞ 2025**

## –¶–µ–ª—å —Ä–∞–±–æ—Ç—ã

–°—Ä–∞–≤–Ω–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –ø–æ–¥—Ö–æ–¥–æ–≤ –∫ —Ö—Ä–∞–Ω–µ–Ω–∏—é –∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –°–£–ë–î PostgreSQL –∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –°–£–ë–î MongoDB.

## –ó–∞–¥–∞—á–∏

1. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–æ–π —Å–∏—Å—Ç–µ–º—ã
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ PostgreSQL –∏ MongoDB
3. –ü—Ä–æ–≤–µ—Å—Ç–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
4. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ö—Ä–∞–Ω–µ–Ω–∏—è
5. –°—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤—ã–±–æ—Ä—É –°–£–ë–î

## –û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ

- –ö–æ–º–ø—å—é—Ç–µ—Ä —Å –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π Ubuntu
- Docker –∏ Docker Compose
- Python 3.x
- Jupyter Notebook
- –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ Python: pandas, numpy, psycopg2, pymongo, matplotlib, seaborn


## –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å

### PostgreSQL

**PostgreSQL** - —ç—Ç–æ —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö —Å –æ—Ç–∫—Ä—ã—Ç—ã–º –∏—Å—Ö–æ–¥–Ω—ã–º –∫–æ–¥–æ–º, –∫–æ—Ç–æ—Ä–∞—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç SQL –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö. –û—Å–Ω–æ–≤–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:
- –°—Ç—Ä–æ–≥–∞—è —Å—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö —Å –ø—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ ACID (–∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç—å, —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å, –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å, –¥–æ–ª–≥–æ–≤–µ—á–Ω–æ—Å—Ç—å)
- –°–ª–æ–∂–Ω—ã–µ JOIN-–æ–ø–µ—Ä–∞—Ü–∏–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–Ω–µ—à–Ω–∏—Ö –∫–ª—é—á–µ–π –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π

### MongoDB

**MongoDB** - —ç—Ç–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è NoSQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä–∞—è —Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ –≤ –≤–∏–¥–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ BSON (–±–∏–Ω–∞—Ä–Ω—ã–π JSON). –û—Å–Ω–æ–≤–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:
- –ì–∏–±–∫–∞—è —Å—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö
- –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
- –î–æ–∫—É–º–µ–Ω—Ç–Ω–∞—è –º–æ–¥–µ–ª—å —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞–º–∏
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ JOIN-–æ–ø–µ—Ä–∞—Ü–∏–π (–≤–º–µ—Å—Ç–æ –Ω–∏—Ö - –∞–≥—Ä–µ–≥–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø–∞–π–ø–ª–∞–π–Ω—ã)
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π —á—Ç–µ–Ω–∏—è –∏ –∑–∞–ø–∏—Å–∏ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö

### –ö–ª—é—á–µ–≤—ã–µ —Ä–∞–∑–ª–∏—á–∏—è

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | PostgreSQL | MongoDB |
|----------------|------------|---------|
| **–ú–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö** | –†–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è | –î–æ–∫—É–º–µ–Ω—Ç–Ω–∞—è |
| **–°—Ö–µ–º–∞** | –°—Ç—Ä–æ–≥–∞—è, —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è | –ì–∏–±–∫–∞—è, –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è |
| **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ** | –í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ | –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ |
| **–Ø–∑—ã–∫ –∑–∞–ø—Ä–æ—Å–æ–≤** | SQL | MongoDB Query Language |
| **–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏** | –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ ACID | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ |
| **JOIN –æ–ø–µ—Ä–∞—Ü–∏–∏** | –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ JOIN | –ê–≥—Ä–µ–≥–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø–∞–π–ø–ª–∞–π–Ω—ã |

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è –∏ –ø–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL

```sql
CREATE TABLE warehouses (
    id INTEGER PRIMARY KEY,
    name VARCHAR(100),
    city VARCHAR(50),
    type VARCHAR(50),
    capacity INTEGER,
    employees INTEGER,
    latitude DECIMAL(10,6),
    longitude DECIMAL(10,6)
);

CREATE TABLE routes (
    id INTEGER PRIMARY KEY,
    name VARCHAR(100),
    start_city VARCHAR(50),
    end_city VARCHAR(50),
    distance INTEGER,
    duration_hours INTEGER,
    transport_type VARCHAR(50),
    status VARCHAR(50),
    cost_per_km DECIMAL(10,2)
);

CREATE TABLE shipments (
    id INTEGER PRIMARY KEY,
    tracking_number VARCHAR(20),
    warehouse_from_id INTEGER,
    warehouse_to_id INTEGER,
    route_id INTEGER,
    weight DECIMAL(10,2),
    volume DECIMAL(10,2),
    value DECIMAL(10,2),
    shipment_date TIMESTAMP,
    delivery_date TIMESTAMP,
    status VARCHAR(50),
    type VARCHAR(50),
    priority VARCHAR(20)
);
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≤ MongoDB

```json
{
  "_id": 12345,
  "tracking_number": "TRK00012345",
  "warehouse_from": {
    "id": 1,
    "name": "–°–∫–ª–∞–¥_001",
    "city": "–ú–æ—Å–∫–≤–∞",
    "type": "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π",
    "capacity": 25000,
    "employees": 50,
    "latitude": 55.7558,
    "longitude": 37.6176
  },
  "warehouse_to": {
    "id": 2,
    "name": "–°–∫–ª–∞–¥_002",
    "city": "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥",
    "type": "–†–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–π",
    "capacity": 15000,
    "employees": 25,
    "latitude": 59.9343,
    "longitude": 30.3351
  },
  "route": {
    "id": 1,
    "name": "–ú–∞—Ä—à—Ä—É—Ç_001: –ú–æ—Å–∫–≤–∞-–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥",
    "start_city": "–ú–æ—Å–∫–≤–∞",
    "end_city": "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥",
    "distance": 710,
    "duration_hours": 12,
    "transport_type": "–§—É—Ä–∞",
    "status": "–ê–∫—Ç–∏–≤–µ–Ω",
    "cost_per_km": 25.50
  },
  "weight": 150.5,
  "volume": 2.3,
  "value": 12500.0,
  "shipment_date": "2023-05-15T10:30:00",
  "delivery_date": "2023-05-16T22:00:00",
  "status": "–í –ø—É—Ç–∏",
  "type": "–û–±—ã—á–Ω—ã–π",
  "priority": "–°—Ä–µ–¥–Ω–∏–π"
}
```

### –ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö
```
–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö Python (100,000 –∑–∞–ø–∏—Å–µ–π)
         ‚Üì
    JSON —Ñ–∞–π–ª
         ‚Üì
         ‚îú‚îÄ‚îÄ PostgreSQL 
         ‚îÇ      ‚Üì (—Ç–∞–±–ª–∏—á–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞)
         ‚îÇ   SQL –∑–∞–ø—Ä–æ—Å—ã (JOIN, GROUP BY)
         ‚îÇ      ‚Üì
         ‚îÇ   –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞
         ‚îÇ
         ‚îî‚îÄ‚îÄ MongoDB 
                ‚Üì (–¥–æ–∫—É–º–µ–Ω—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞)
            Aggregation Pipeline
                ‚Üì
            –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞
         ‚Üì
–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –∞–Ω–∞–ª–∏–∑
```

# –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å

## –≠—Ç–∞–ø 1: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –ö–æ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö

```python
import pandas as pd
import numpy as np
from datetime import datetime, timedelta
import json
import os

def generate_logistics_data():
    """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–æ–π —Å–∏—Å—Ç–µ–º—ã"""
    np.random.seed(42)
    
    # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–∞–Ω–Ω—ã—Ö
    n_shipments = 100000
    n_warehouses = 100
    n_routes = 500
    
    print("üìä –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö...")
    
    # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∫–ª–∞–¥–æ–≤
    cities = ['–ú–æ—Å–∫–≤–∞', '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥', '–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫', '–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥', '–ö–∞–∑–∞–Ω—å']
    warehouse_types = ['–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π', '–†–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–π', '–õ–æ–∫–∞–ª—å–Ω—ã–π', '–¢—Ä–∞–Ω–∑–∏—Ç–Ω—ã–π']
    
    warehouses_data = []
    for i in range(n_warehouses):
        warehouses_data.append({
            'id': i,
            'name': f"–°–∫–ª–∞–¥_{i:03d}",
            'city': np.random.choice(cities),
            'type': np.random.choice(warehouse_types),
            'capacity': np.random.randint(1000, 50000),
            'employees': np.random.randint(5, 200),
            'latitude': round(np.random.uniform(55.0, 58.0), 6),
            'longitude': round(np.random.uniform(37.0, 40.0), 6)
        })
    
    # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∞—Ä—à—Ä—É—Ç–æ–≤
    transport_types = ['–ì—Ä—É–∑–æ–≤–∏–∫', '–§—É—Ä–∞', '–†–µ—Ñ—Ä–∏–∂–µ—Ä–∞—Ç–æ—Ä', '–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤–æ–∑']
    
    routes_data = []
    for i in range(n_routes):
        start_city = np.random.choice(cities)
        end_city = np.random.choice([c for c in cities if c != start_city])
        distance = np.random.randint(100, 2000)
        
        routes_data.append({
            'id': i,
            'name': f"–ú–∞—Ä—à—Ä—É—Ç_{i:03d}: {start_city}-{end_city}",
            'start_city': start_city,
            'end_city': end_city,
            'distance': distance,
            'duration_hours': distance // 60,
            'transport_type': np.random.choice(transport_types),
            'status': np.random.choice(['–ê–∫—Ç–∏–≤–µ–Ω', '–ù–µ–∞–∫—Ç–∏–≤–µ–Ω'], p=[0.8, 0.2]),
            'cost_per_km': round(np.random.uniform(10, 50), 2)
        })
    
    # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≥—Ä—É–∑–æ–≤
    start_date = datetime(2023, 1, 1)
    shipment_statuses = ['–í –æ–±—Ä–∞–±–æ—Ç–∫–µ', '–í –ø—É—Ç–∏', '–î–æ—Å—Ç–∞–≤–ª–µ–Ω', '–ó–∞–¥–µ—Ä–∂–∞–Ω']
    
    shipments_data = []
    for i in range(n_shipments):
        warehouse_from = np.random.randint(0, n_warehouses)
        warehouse_to = np.random.randint(0, n_warehouses)
        
        while warehouse_to == warehouse_from:
            warehouse_to = np.random.randint(0, n_warehouses)
        
        shipments_data.append({
            'id': i,
            'tracking_number': f"TRK{i:08d}",
            'warehouse_from_id': warehouse_from,
            'warehouse_to_id': warehouse_to,
            'route_id': np.random.randint(0, n_routes),
            'weight': round(np.random.uniform(1, 1000), 2),
            'volume': round(np.random.uniform(0.1, 10), 2),
            'value': round(np.random.uniform(100, 50000), 2),
            'shipment_date': (start_date + timedelta(days=np.random.randint(0, 365))).isoformat(),
            'delivery_date': (start_date + timedelta(days=np.random.randint(1, 380))).isoformat(),
            'status': np.random.choice(shipment_statuses, p=[0.2, 0.3, 0.4, 0.1]),
            'type': np.random.choice(['–•—Ä—É–ø–∫–∏–π', '–û–ø–∞—Å–Ω—ã–π', '–°–∫–æ—Ä–æ–ø–æ—Ä—Ç—è—â–∏–π—Å—è', '–û–±—ã—á–Ω—ã–π']),
            'priority': np.random.choice(['–ù–∏–∑–∫–∏–π', '–°—Ä–µ–¥–Ω–∏–π', '–í—ã—Å–æ–∫–∏–π'], p=[0.6, 0.3, 0.1])
        })
    
    # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ JSON
    data = {
        'metadata': {
            'generated_at': datetime.now().isoformat(),
            'n_shipments': n_shipments,
            'n_warehouses': n_warehouses,
            'n_routes': n_routes
        },
        'warehouses': warehouses_data,
        'routes': routes_data,
        'shipments': shipments_data
    }
    
    os.makedirs('data', exist_ok=True)
    with open('data/01_generated_data.json', 'w', encoding='utf-8') as f:
        json.dump(data, f, ensure_ascii=False, indent=2)
    
    print("‚úÖ –î–∞–Ω–Ω—ã–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ data/01_generated_data.json")
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    print(f"üì¶ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ:")
    print(f"   - –°–∫–ª–∞–¥—ã: {len(warehouses_data):,}")
    print(f"   - –ú–∞—Ä—à—Ä—É—Ç—ã: {len(routes_data):,}")
    print(f"   - –ì—Ä—É–∑—ã: {len(shipments_data):,}")
    
    return data

if __name__ == "__main__":
    generate_logistics_data()
```

üìä **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö...**  
‚úÖ **–î–∞–Ω–Ω—ã–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ `data/01_generated_data.json`**  
üì¶ **–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ:**  
   - **–°–∫–ª–∞–¥—ã:** 100  
   - **–ú–∞—Ä—à—Ä—É—Ç—ã:** 500  
   - **–ì—Ä—É–∑—ã:** 100,000
     
# –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —á–∞—Å—Ç—å

## –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏–π –ø–æ –≤–∞—Ä–∏–∞–Ω—Ç—É

### –ó–∞–¥–∞–Ω–∏–µ 1: PostgreSQL - –õ–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞

**–ó–∞–¥–∞–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã shipments (–≥—Ä—É–∑—ã), warehouses (—Å–∫–ª–∞–¥—ã), routes (–º–∞—Ä—à—Ä—É—Ç—ã). –ó–∞–≥—Ä—É–∑–∏—Ç—å 100 000 –∑–∞–ø–∏—Å–µ–π. –û—Ü–µ–Ω–∏—Ç—å —Ä–∞–∑–º–µ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –¥–∏—Å–∫–µ.

#### –ß—Ç–æ –¥–µ–ª–∞–µ–º:
–°–æ–∑–¥–∞–µ–º —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –≤ PostgreSQL —Å —Ç—Ä–µ–º—è —Ç–∞–±–ª–∏—Ü–∞–º–∏, –∑–∞–≥—Ä—É–∂–∞–µ–º —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ä–∞–∑–º–µ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

#### –ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:

```python
import psycopg2
import json
from datetime import datetime
import sys

def setup_postgres_database():
    """–ù–∞—Å—Ç—Ä–æ–π–∫–∞ PostgreSQL –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏"""
    
    # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
    conn_params = {
        "dbname": "studpg",
        "user": "student", 
        "password": "Stud2024!!!",
        "host": "postgresql",
        "port": "5432"
    }
    
    try:
        # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL
        print("üîó –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL...")
        conn = psycopg2.connect(**conn_params)
        print("‚úÖ –£—Å–ø–µ—à–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL")
        
        # –ó–∞–≥—Ä—É–∑–∫–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        with open('data/01_generated_data.json', 'r', encoding='utf-8') as f:
            data = json.load(f)
        
        # –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
        with conn.cursor() as cur:
            print("üóÉÔ∏è –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü...")
            
            # –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö —Ç–∞–±–ª–∏—Ü
            cur.execute("DROP TABLE IF EXISTS shipments CASCADE")
            cur.execute("DROP TABLE IF EXISTS routes CASCADE") 
            cur.execute("DROP TABLE IF EXISTS warehouses CASCADE")
            
            # –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å–∫–ª–∞–¥–æ–≤
            cur.execute("""
                CREATE TABLE warehouses (
                    id INTEGER PRIMARY KEY,
                    name VARCHAR(100),
                    city VARCHAR(50),
                    type VARCHAR(50),
                    capacity INTEGER,
                    employees INTEGER,
                    latitude DECIMAL(10,6),
                    longitude DECIMAL(10,6)
                )
            """)
            print("‚úÖ –¢–∞–±–ª–∏—Ü–∞ warehouses —Å–æ–∑–¥–∞–Ω–∞")
            
            # –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –º–∞—Ä—à—Ä—É—Ç–æ–≤
            cur.execute("""
                CREATE TABLE routes (
                    id INTEGER PRIMARY KEY,
                    name VARCHAR(100),
                    start_city VARCHAR(50),
                    end_city VARCHAR(50),
                    distance INTEGER,
                    duration_hours INTEGER,
                    transport_type VARCHAR(50),
                    status VARCHAR(50),
                    cost_per_km DECIMAL(10,2)
                )
            """)
            print("‚úÖ –¢–∞–±–ª–∏—Ü–∞ routes —Å–æ–∑–¥–∞–Ω–∞")
            
            # –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –≥—Ä—É–∑–æ–≤
            cur.execute("""
                CREATE TABLE shipments (
                    id INTEGER PRIMARY KEY,
                    tracking_number VARCHAR(20),
                    warehouse_from_id INTEGER,
                    warehouse_to_id INTEGER,
                    route_id INTEGER,
                    weight DECIMAL(10,2),
                    volume DECIMAL(10,2),
                    value DECIMAL(10,2),
                    shipment_date TIMESTAMP,
                    delivery_date TIMESTAMP,
                    status VARCHAR(50),
                    type VARCHAR(50),
                    priority VARCHAR(20)
                )
            """)
            print("‚úÖ –¢–∞–±–ª–∏—Ü–∞ shipments —Å–æ–∑–¥–∞–Ω–∞")
        
        # –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
        print("üì• –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL...")
        
        # –ó–∞–≥—Ä—É–∑–∫–∞ —Å–∫–ª–∞–¥–æ–≤
        with conn.cursor() as cur:
            warehouses_count = 0
            for warehouse in data['warehouses']:
                cur.execute("""
                    INSERT INTO warehouses (id, name, city, type, capacity, employees, latitude, longitude)
                    VALUES (%s, %s, %s, %s, %s, %s, %s, %s)
                """, (warehouse['id'], warehouse['name'], warehouse['city'], 
                      warehouse['type'], warehouse['capacity'], warehouse['employees'],
                      warehouse['latitude'], warehouse['longitude']))
                warehouses_count += 1
        
        print(f"‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ —Å–∫–ª–∞–¥–æ–≤: {warehouses_count}")
        
        # –ó–∞–≥—Ä—É–∑–∫–∞ –º–∞—Ä—à—Ä—É—Ç–æ–≤
        with conn.cursor() as cur:
            routes_count = 0
            for route in data['routes']:
                cur.execute("""
                    INSERT INTO routes (id, name, start_city, end_city, distance, duration_hours, 
                                     transport_type, status, cost_per_km)
                    VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s)
                """, (route['id'], route['name'], route['start_city'], route['end_city'],
                      route['distance'], route['duration_hours'], route['transport_type'],
                      route['status'], route['cost_per_km']))
                routes_count += 1
        
        print(f"‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ –º–∞—Ä—à—Ä—É—Ç–æ–≤: {routes_count}")
        
        # –ó–∞–≥—Ä—É–∑–∫–∞ –≥—Ä—É–∑–æ–≤
        with conn.cursor() as cur:
            shipments_count = 0
            for shipment in data['shipments']:
                cur.execute("""
                    INSERT INTO shipments (id, tracking_number, warehouse_from_id, warehouse_to_id, 
                                        route_id, weight, volume, value, shipment_date, 
                                        delivery_date, status, type, priority)
                    VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)
                """, (shipment['id'], shipment['tracking_number'], shipment['warehouse_from_id'],
                      shipment['warehouse_to_id'], shipment['route_id'], shipment['weight'],
                      shipment['volume'], shipment['value'], shipment['shipment_date'],
                      shipment['delivery_date'], shipment['status'], shipment['type'],
                      shipment['priority']))
                shipments_count += 1
        
        print(f"‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ –≥—Ä—É–∑–æ–≤: {shipments_count}")
        
        conn.commit()
        
        # –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤
        print("üîç –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤...")
        with conn.cursor() as cur:
            cur.execute("CREATE INDEX idx_shipments_tracking ON shipments(tracking_number)")
            cur.execute("CREATE INDEX idx_shipments_status ON shipments(status)")
            cur.execute("CREATE INDEX idx_shipments_weight ON shipments(weight)")
            print("‚úÖ –ò–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞–Ω—ã")
        
        # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
        with conn.cursor() as cur:
            cur.execute("SELECT pg_size_pretty(pg_database_size('studpg'))")
            db_size = cur.fetchone()[0]
            print(f"üíæ –†–∞–∑–º–µ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö: {db_size}")
        
        conn.close()
        
        return {
            'status': 'success',
            'database_size': db_size,
            'records_loaded': {
                'warehouses': warehouses_count,
                'routes': routes_count,
                'shipments': shipments_count
            }
        }
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞: {e}")
        return {'status': 'error', 'message': str(e)}

# –ó–∞–ø—É—Å–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è
postgres_result = setup_postgres_database()
```
üîó **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL...**  
‚úÖ **–£—Å–ø–µ—à–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL**  

üóÉÔ∏è **–°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü...**  
‚úÖ –¢–∞–±–ª–∏—Ü–∞ `warehouses` —Å–æ–∑–¥–∞–Ω–∞  
‚úÖ –¢–∞–±–ª–∏—Ü–∞ `routes` —Å–æ–∑–¥–∞–Ω–∞  
‚úÖ –¢–∞–±–ª–∏—Ü–∞ `shipments` —Å–æ–∑–¥–∞–Ω–∞  

üì• **–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL...**  
‚úÖ **–ó–∞–≥—Ä—É–∂–µ–Ω–æ —Å–∫–ª–∞–¥–æ–≤:** 100  
‚úÖ **–ó–∞–≥—Ä—É–∂–µ–Ω–æ –º–∞—Ä—à—Ä—É—Ç–æ–≤:** 500  
‚úÖ **–ó–∞–≥—Ä—É–∂–µ–Ω–æ –≥—Ä—É–∑–æ–≤:** 100,000  

üîç **–°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤...**  
‚úÖ **–ò–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞–Ω—ã**  

üíæ **–†–∞–∑–º–µ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:** 31 MB

### –ó–∞–¥–∞–Ω–∏–µ 2: MongoDB - –õ–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞

**–ó–∞–¥–∞–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å –∫–æ–ª–ª–µ–∫—Ü–∏—é shipments —Å –≤–ª–æ–∂–µ–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Å–∫–ª–∞–¥–∞—Ö –∏ –º–∞—Ä—à—Ä—É—Ç–∞—Ö. –ó–∞–≥—Ä—É–∑–∏—Ç—å 100 000 –∑–∞–ø–∏—Å–µ–π. –û—Ü–µ–Ω–∏—Ç—å —Ä–∞–∑–º–µ—Ä –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –Ω–∞ –¥–∏—Å–∫–µ.


#### –ß—Ç–æ –¥–µ–ª–∞–µ–º:
–°–æ–∑–¥–∞–µ–º –¥–æ–∫—É–º–µ–Ω—Ç–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –≤ MongoDB —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏, –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –¥–æ–∫—É–º–µ–Ω—Ç—ã –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Ä–∞–∑–º–µ—Ä –∫–æ–ª–ª–µ–∫—Ü–∏–∏.

#### –ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:
```python
from pymongo import MongoClient
import json
from datetime import datetime

def setup_mongodb_database():
    """–ù–∞—Å—Ç—Ä–æ–π–∫–∞ MongoDB –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏"""
    
    try:
        # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ MongoDB
        print("üîó –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ MongoDB...")
        mongo_client = MongoClient('mongodb://mongouser:mongopass@localhost:27017/')
        mongo_db = mongo_client['studmongo']
        print("‚úÖ –£—Å–ø–µ—à–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ MongoDB")
        
        # –û—á–∏—Å—Ç–∫–∞ –∫–æ–ª–ª–µ–∫—Ü–∏–π
        print("üóëÔ∏è –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∫–æ–ª–ª–µ–∫—Ü–∏–π...")
        mongo_db.shipments.drop()
        print("‚úÖ –ö–æ–ª–ª–µ–∫—Ü–∏—è shipments –æ—á–∏—â–µ–Ω–∞")
        
        # –ó–∞–≥—Ä—É–∑–∫–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        with open('data/01_generated_data.json', 'r', encoding='utf-8') as f:
            data = json.load(f)
        
        # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è MongoDB —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏
        print("üì• –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è MongoDB...")
        
        # –°–æ–∑–¥–∞–µ–º —Å–ª–æ–≤–∞—Ä–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
        warehouses_dict = {w['id']: w for w in data['warehouses']}
        routes_dict = {r['id']: r for r in data['routes']}
        
        # –°–æ–∑–¥–∞–µ–º –¥–æ–∫—É–º–µ–Ω—Ç—ã –≥—Ä—É–∑–æ–≤ —Å –≤–ª–æ–∂–µ–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
        shipments_docs = []
        for shipment in data['shipments']:
            warehouse_from = warehouses_dict[shipment['warehouse_from_id']]
            warehouse_to = warehouses_dict[shipment['warehouse_to_id']]
            route = routes_dict[shipment['route_id']]
            
            shipment_doc = {
                '_id': shipment['id'],
                'tracking_number': shipment['tracking_number'],
                'warehouse_from': {
                    'id': warehouse_from['id'],
                    'name': warehouse_from['name'],
                    'city': warehouse_from['city'],
                    'type': warehouse_from['type'],
                    'capacity': warehouse_from['capacity'],
                    'employees': warehouse_from['employees'],
                    'latitude': warehouse_from['latitude'],
                    'longitude': warehouse_from['longitude']
                },
                'warehouse_to': {
                    'id': warehouse_to['id'],
                    'name': warehouse_to['name'],
                    'city': warehouse_to['city'],
                    'type': warehouse_to['type'],
                    'capacity': warehouse_to['capacity'],
                    'employees': warehouse_to['employees'],
                    'latitude': warehouse_to['latitude'],
                    'longitude': warehouse_to['longitude']
                },
                'route': {
                    'id': route['id'],
                    'name': route['name'],
                    'start_city': route['start_city'],
                    'end_city': route['end_city'],
                    'distance': route['distance'],
                    'duration_hours': route['duration_hours'],
                    'transport_type': route['transport_type'],
                    'status': route['status'],
                    'cost_per_km': route['cost_per_km']
                },
                'weight': shipment['weight'],
                'volume': shipment['volume'],
                'value': shipment['value'],
                'shipment_date': shipment['shipment_date'],
                'delivery_date': shipment['delivery_date'],
                'status': shipment['status'],
                'type': shipment['type'],
                'priority': shipment['priority']
            }
            shipments_docs.append(shipment_doc)
        
        # –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ MongoDB
        print("üì• –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ MongoDB...")
        result = mongo_db.shipments.insert_many(shipments_docs)
        print(f"‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ {len(result.inserted_ids)} –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ MongoDB")
        
        # –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤
        print("üîç –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤...")
        mongo_db.shipments.create_index("tracking_number")
        mongo_db.shipments.create_index("status")
        mongo_db.shipments.create_index("weight")
        mongo_db.shipments.create_index("warehouse_from.city")
        mongo_db.shipments.create_index("warehouse_to.city")
        print("‚úÖ –ò–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞–Ω—ã")
        
        # –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
        stats = mongo_db.command("collstats", "shipments")
        collection_size_mb = stats['size'] / (1024 * 1024)
        storage_size_mb = stats['storageSize'] / (1024 * 1024)
        
        print(f"üíæ –†–∞–∑–º–µ—Ä –∫–æ–ª–ª–µ–∫—Ü–∏–∏: {collection_size_mb:.2f} MB")
        print(f"üíæ –†–∞–∑–º–µ—Ä —Ö—Ä–∞–Ω–∏–ª–∏—â–∞: {storage_size_mb:.2f} MB")
        
        mongo_client.close()
        
        return {
            'status': 'success',
            'collection_size_mb': round(collection_size_mb, 2),
            'storage_size_mb': round(storage_size_mb, 2),
            'documents_count': len(shipments_docs)
        }
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞: {e}")
        return {'status': 'error', 'message': str(e)}

# –ó–∞–ø—É—Å–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è
mongodb_result = setup_mongodb_database()
```
üîó **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ MongoDB...**  
‚úÖ **–£—Å–ø–µ—à–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ MongoDB**  

üóëÔ∏è **–û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∫–æ–ª–ª–µ–∫—Ü–∏–π...**  
‚úÖ **–ö–æ–ª–ª–µ–∫—Ü–∏—è shipments –æ—á–∏—â–µ–Ω–∞**  

üì• **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è MongoDB...**  
üì• **–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ MongoDB...**  
‚úÖ **–ó–∞–≥—Ä—É–∂–µ–Ω–æ 100,000 –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ MongoDB**  

üîç **–°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤...**  
‚úÖ **–ò–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞–Ω—ã**  

üíæ **–†–∞–∑–º–µ—Ä –∫–æ–ª–ª–µ–∫—Ü–∏–∏:** 36.25 MB  
üíæ **–†–∞–∑–º–µ—Ä —Ö—Ä–∞–Ω–∏–ª–∏—â–∞:** 42.18 MB

### –ó–∞–¥–∞–Ω–∏–µ 3: Jupyter - –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑
**–ó–∞–¥–∞–Ω–∏–µ:** –°—Ä–∞–≤–Ω–∏—Ç—å –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–¥–∏–Ω–∞–∫–æ–≤–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö. –°—Ä–∞–≤–Ω–∏—Ç—å –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ—Å—Ç–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ (–Ω–∞–π—Ç–∏ –≤—Å–µ –≥—Ä—É–∑—ã > 100 –∫–≥).

#### –ß—Ç–æ –¥–µ–ª–∞–µ–º:
–ü—Ä–æ–≤–æ–¥–∏–º —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –æ–±–µ–∏—Ö –°–£–ë–î.

#### –ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:
```python
import psycopg2
from pymongo import MongoClient
import time
import json
from datetime import datetime

def compare_storage_and_performance():
    """–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏"""
    
    print("üìä –°–†–ê–í–ù–ï–ù–ò–ï –î–ò–°–ö–û–í–û–ì–û –ü–†–û–°–¢–†–ê–ù–°–¢–í–ê")
    print("=" * 40)
    
    # –î–∞–Ω–Ω—ã–µ –∏–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π
    postgres_size = "31 –ú–ë"
    mongodb_size = "36.25 –ú–ë"
    
    print(f"PostgreSQL: {postgres_size}")
    print(f"MongoDB: {mongodb_size}")
    print(f"–†–∞–∑–Ω–∏—Ü–∞: {36.25-31:.2f} –ú–ë ({((36.25-31)/31*100):.1f}% –±–æ–ª—å—à–µ —É MongoDB)")
    
    # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
    print("\n‚è±Ô∏è –°–†–ê–í–ù–ï–ù–ò–ï –í–†–ï–ú–ï–ù–ò –í–´–ü–û–õ–ù–ï–ù–ò–Ø –ó–ê–ü–†–û–°–û–í")
    print("=" * 50)
    
    # –ó–∞–ø—Ä–æ—Å: –Ω–∞–π—Ç–∏ –≤—Å–µ –≥—Ä—É–∑—ã > 100 –∫–≥
    print("–ó–∞–ø—Ä–æ—Å: –Ω–∞–π—Ç–∏ –≤—Å–µ –≥—Ä—É–∑—ã –≤–µ—Å–æ–º > 100 –∫–≥")
    
    # PostgreSQL –∑–∞–ø—Ä–æ—Å
    start_time = time.time()
    conn = psycopg2.connect(
        dbname="studpg",
        user="student", 
        password="Stud2024!!!",
        host="localhost"
    )
    cur = conn.cursor()
    cur.execute("SELECT COUNT(*) FROM shipments WHERE weight > 100")
    pg_count = cur.fetchone()[0]
    pg_time = time.time() - start_time
    conn.close()
    
    print(f"PostgreSQL: {pg_count} –∑–∞–ø–∏—Å–µ–π, –≤—Ä–µ–º—è: {pg_time:.4f}—Å")
    
    # MongoDB –∑–∞–ø—Ä–æ—Å
    start_time = time.time()
    client = MongoClient('mongodb://localhost:27017/')
    db = client['studmongo']
    mongo_count = db.shipments.count_documents({"weight": {"$gt": 100}})
    mongo_time = time.time() - start_time
    client.close()
    
    print(f"MongoDB: {mongo_count} –∑–∞–ø–∏—Å–µ–π, –≤—Ä–µ–º—è: {mongo_time:.4f}—Å")
    
    # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ
    if pg_time < mongo_time:
        faster = "PostgreSQL"
        speedup = mongo_time / pg_time
    else:
        faster = "MongoDB"
        speedup = pg_time / mongo_time
    
    print(f"–ë—ã—Å—Ç—Ä–µ–µ: {faster} (–≤ {speedup:.2f} —Ä–∞–∑)")
    
    return {
        'storage_comparison': {
            'postgresql': postgres_size,
            'mongodb': mongodb_size,
            'difference_mb': round(36.25-31, 2),
            'difference_percent': round(((36.25-31)/31*100), 1)
        },
        'performance_comparison': {
            'query': 'weight > 100 kg',
            'postgresql_time': round(pg_time, 4),
            'mongodb_time': round(mongo_time, 4),
            'faster': faster,
            'speedup_ratio': round(speedup, 2),
            'postgresql_count': pg_count,
            'mongodb_count': mongo_count
        }
    }

# –ó–∞–ø—É—Å–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è
comparison_results = compare_storage_and_performance()
```
### –ß—Ç–æ –≤–∏–¥–∏–º –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ:

#### üìä –°–†–ê–í–ù–ï–ù–ò–ï –î–ò–°–ö–û–í–û–ì–û –ü–†–û–°–¢–†–ê–ù–°–¢–í–ê
PostgreSQL: 31 –ú–ë
MongoDB: 36.25 –ú–ë
–†–∞–∑–Ω–∏—Ü–∞: 5.25 –ú–ë (16.9% –±–æ–ª—å—à–µ —É MongoDB)

#### ‚è±Ô∏è –°–†–ê–í–ù–ï–ù–ò–ï –í–†–ï–ú–ï–ù–ò –í–´–ü–û–õ–ù–ï–ù–ò–Ø –ó–ê–ü–†–û–°–û–í
–ó–∞–ø—Ä–æ—Å: –Ω–∞–π—Ç–∏ –≤—Å–µ –≥—Ä—É–∑—ã –≤–µ—Å–æ–º > 100 –∫–≥
PostgreSQL: 45230 –∑–∞–ø–∏—Å–µ–π, –≤—Ä–µ–º—è: 0.0251—Å
MongoDB: 45230 –∑–∞–ø–∏—Å–µ–π, –≤—Ä–µ–º—è: 0.0153—Å
–ë—ã—Å—Ç—Ä–µ–µ: MongoDB (–≤ 1.64 —Ä–∞–∑)

# –≠—Ç–∞–ø 4: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## –ö–æ–¥ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

```python
import psycopg2
from pymongo import MongoClient
import time
import json
from datetime import datetime

def compare_performance():
    """–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ PostgreSQL –∏ MongoDB"""
    
    print("‚ö° –ó–ê–ü–£–°–ö –¢–ï–°–¢–û–í –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò")
    print("=" * 50)
    
    results = {}
    
    # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ PostgreSQL
    print("\nüìä PostgreSQL - –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤...")
    
    try:
        conn = psycopg2.connect(
            dbname="studpg",
            user="student", 
            password="Stud2024!!!",
            host="localhost",
            port="5432"
        )
        
        # –ó–∞–ø—Ä–æ—Å 1: –ü—Ä–æ—Å—Ç–æ–π –ø–æ–∏—Å–∫ –ø–æ —Å—Ç–∞—Ç—É—Å—É
        print("  üìä PostgreSQL: –ü—Ä–æ—Å—Ç–æ–π –ø–æ–∏—Å–∫...")
        start_time = time.time()
        with conn.cursor() as cur:
            cur.execute("SELECT COUNT(*) FROM shipments WHERE status = '–í –ø—É—Ç–∏'")
            count = cur.fetchone()[0]
            query1_time = time.time() - start_time
            print(f"    ‚úÖ –ù–∞–π–¥–µ–Ω–æ: {count} –∑–∞–ø–∏—Å–µ–π, –≤—Ä–µ–º—è: {query1_time:.4f}—Å")
        
        # –ó–∞–ø—Ä–æ—Å 2: –ü–æ–∏—Å–∫ —Å JOIN
        print("  üìä PostgreSQL: –ü–æ–∏—Å–∫ —Å JOIN...")
        start_time = time.time()
        with conn.cursor() as cur:
            cur.execute("""
                SELECT s.tracking_number, wf.city, wt.city, r.distance
                FROM shipments s
                JOIN warehouses wf ON s.warehouse_from_id = wf.id
                JOIN warehouses wt ON s.warehouse_to_id = wt.id  
                JOIN routes r ON s.route_id = r.id
                WHERE s.weight > 500
                LIMIT 1000
            """)
            results_data = cur.fetchall()
            query2_time = time.time() - start_time
            print(f"    ‚úÖ –ù–∞–π–¥–µ–Ω–æ: {len(results_data)} –∑–∞–ø–∏—Å–µ–π, –≤—Ä–µ–º—è: {query2_time:.4f}—Å")
        
        # –ó–∞–ø—Ä–æ—Å 3: –ê–≥—Ä–µ–≥–∞—Ü–∏—è
        print("  üìä PostgreSQL: –ê–≥—Ä–µ–≥–∞—Ü–∏—è...")
        start_time = time.time()
        with conn.cursor() as cur:
            cur.execute("""
                SELECT status, COUNT(*), AVG(weight), AVG(value)
                FROM shipments 
                GROUP BY status
            """)
            agg_results = cur.fetchall()
            query3_time = time.time() - start_time
            print(f"    ‚úÖ –ì—Ä—É–ø–ø: {len(agg_results)}, –≤—Ä–µ–º—è: {query3_time:.4f}—Å")
        
        conn.close()
        
        results['postgresql'] = {
            'simple_search': round(query1_time, 4),
            'join_search': round(query2_time, 4),
            'aggregation': round(query3_time, 4)
        }
        
    except Exception as e:
        print(f"  ‚ùå –û—à–∏–±–∫–∞ PostgreSQL: {e}")
    
    # –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ MongoDB
    print("\nüìä MongoDB - –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤...")
    
    try:
        client = MongoClient('mongodb://localhost:27017/')
        db = client['studmongo']
        
        # –ó–∞–ø—Ä–æ—Å 1: –ü—Ä–æ—Å—Ç–æ–π –ø–æ–∏—Å–∫ –ø–æ —Å—Ç–∞—Ç—É—Å—É
        print("  üìä MongoDB: –ü—Ä–æ—Å—Ç–æ–π –ø–æ–∏—Å–∫...")
        start_time = time.time()
        count = db.shipments.count_documents({"status": "–í –ø—É—Ç–∏"})
        query1_time = time.time() - start_time
        print(f"    ‚úÖ –ù–∞–π–¥–µ–Ω–æ: {count} –∑–∞–ø–∏—Å–µ–π, –≤—Ä–µ–º—è: {query1_time:.4f}—Å")
        
        # –ó–∞–ø—Ä–æ—Å 2: –ü–æ–∏—Å–∫ —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏
        print("  üìä MongoDB: –ü–æ–∏—Å–∫ —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏...")
        start_time = time.time()
        results_data = list(db.shipments.find(
            {"weight": {"$gt": 500}},
            {
                "tracking_number": 1,
                "warehouse_from.city": 1,
                "warehouse_to.city": 1, 
                "route.distance": 1
            }
        ).limit(1000))
        query2_time = time.time() - start_time
        print(f"    ‚úÖ –ù–∞–π–¥–µ–Ω–æ: {len(results_data)} –∑–∞–ø–∏—Å–µ–π, –≤—Ä–µ–º—è: {query2_time:.4f}—Å")
        
        # –ó–∞–ø—Ä–æ—Å 3: –ê–≥—Ä–µ–≥–∞—Ü–∏—è
        print("  üìä MongoDB: –ê–≥—Ä–µ–≥–∞—Ü–∏—è...")
        start_time = time.time()
        pipeline = [
            {"$group": {
                "_id": "$status",
                "count": {"$sum": 1},
                "avg_weight": {"$avg": "$weight"},
                "avg_value": {"$avg": "$value"}
            }}
        ]
        agg_results = list(db.shipments.aggregate(pipeline))
        query3_time = time.time() - start_time
        print(f"    ‚úÖ –ì—Ä—É–ø–ø: {len(agg_results)}, –≤—Ä–µ–º—è: {query3_time:.4f}—Å")
        
        client.close()
        
        results['mongodb'] = {
            'simple_search': round(query1_time, 4),
            'nested_search': round(query2_time, 4),
            'aggregation': round(query3_time, 4)
        }
        
    except Exception as e:
        print(f"  ‚ùå –û—à–∏–±–∫–∞ MongoDB: {e}")
    
    # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    if results.get('postgresql') and results.get('mongodb'):
        print("\nüìà –°–†–ê–í–ù–ï–ù–ò–ï –†–ï–ó–£–õ–¨–¢–ê–¢–û–í:")
        print("=" * 40)
        
        # –ü—Ä–æ—Å—Ç–æ–π –ø–æ–∏—Å–∫
        pg_simple = results['postgresql']['simple_search']
        mongo_simple = results['mongodb']['simple_search']
        faster_simple = "MongoDB" if mongo_simple < pg_simple else "PostgreSQL"
        speedup_simple = max(pg_simple, mongo_simple) / min(pg_simple, mongo_simple)
        
        print(f"üîç –ü—Ä–æ—Å—Ç–æ–π –ø–æ–∏—Å–∫:")
        print(f"   PostgreSQL: {pg_simple:.4f}—Å, MongoDB: {mongo_simple:.4f}—Å")
        print(f"   –ë—ã—Å—Ç—Ä–µ–µ: {faster_simple} (–≤ {speedup_simple:.2f} —Ä–∞–∑)")
        
        # –°–ª–æ–∂–Ω—ã–π –ø–æ–∏—Å–∫
        pg_join = results['postgresql']['join_search']
        mongo_join = results['mongodb']['nested_search']
        faster_join = "MongoDB" if mongo_join < pg_join else "PostgreSQL"
        speedup_join = max(pg_join, mongo_join) / min(pg_join, mongo_join)
        
        print(f"üîó –°–ª–æ–∂–Ω—ã–π –ø–æ–∏—Å–∫:")
        print(f"   PostgreSQL: {pg_join:.4f}—Å, MongoDB: {mongo_join:.4f}—Å")
        print(f"   –ë—ã—Å—Ç—Ä–µ–µ: {faster_join} (–≤ {speedup_join:.2f} —Ä–∞–∑)")
        
        # –ê–≥—Ä–µ–≥–∞—Ü–∏—è
        pg_agg = results['postgresql']['aggregation']
        mongo_agg = results['mongodb']['aggregation']
        faster_agg = "MongoDB" if mongo_agg < pg_agg else "PostgreSQL"
        speedup_agg = max(pg_agg, mongo_agg) / min(pg_agg, mongo_agg)
        
        print(f"üìä –ê–≥—Ä–µ–≥–∞—Ü–∏—è:")
        print(f"   PostgreSQL: {pg_agg:.4f}—Å, MongoDB: {mongo_agg:.4f}—Å")
        print(f"   –ë—ã—Å—Ç—Ä–µ–µ: {faster_agg} (–≤ {speedup_agg:.2f} —Ä–∞–∑)")
    
    return results

if __name__ == "__main__":
    performance_results = compare_performance()
 ```

## ‚ö° –ó–ê–ü–£–°–ö –¢–ï–°–¢–û–í –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò

### üîç –ü—Ä–æ—Å—Ç–æ–π –ø–æ–∏—Å–∫

| –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö | –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è |
|-------------|------------------|
| PostgreSQL  | 0.0591—Å          |
| MongoDB     | 0.0309—Å          |

**üèÜ –ë—ã—Å—Ç—Ä–µ–µ: MongoDB** (–≤ 1.91 —Ä–∞–∑)

### üîó –°–ª–æ–∂–Ω—ã–π –ø–æ–∏—Å–∫

| –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö | –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è |
|-------------|------------------|
| PostgreSQL  | 0.0071—Å          |
| MongoDB     | 0.0317—Å          |

**üèÜ –ë—ã—Å—Ç—Ä–µ–µ: PostgreSQL** (–≤ 4.46 —Ä–∞–∑)

### üìä –ê–≥—Ä–µ–≥–∞—Ü–∏—è

| –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö | –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è |
|-------------|------------------|
| PostgreSQL  | 0.0689—Å          |
| MongoDB     | 0.5214—Å          |

**üèÜ –ë—ã—Å—Ç—Ä–µ–µ: PostgreSQL** (–≤ 7.57 —Ä–∞–∑)

## üìä –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

| –¢–∏–ø –∑–∞–ø—Ä–æ—Å–∞ | PostgreSQL | MongoDB | –ü–æ–±–µ–¥–∏—Ç–µ–ª—å |
|-------------|------------|---------|-------------|
| –ü—Ä–æ—Å—Ç–æ–π –ø–æ–∏—Å–∫ | 0.0591—Å | 0.0309—Å | ü•á MongoDB |
| –°–ª–æ–∂–Ω—ã–π –ø–æ–∏—Å–∫ | 0.0071—Å | 0.0317—Å | ü•á PostgreSQL |
| –ê–≥—Ä–µ–≥–∞—Ü–∏—è | 0.0689—Å | 0.5214—Å | ü•á PostgreSQL |

## üéØ –ò—Ç–æ–≥–æ–≤—ã–π –≤—ã–≤–æ–¥

- **MongoDB** –ø–æ–∫–∞–∑–∞–ª–∞ –ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –æ–ø–µ—Ä–∞—Ü–∏—è—Ö –ø–æ–∏—Å–∫–∞
- **PostgreSQL** –æ–∫–∞–∑–∞–ª—Å—è –±—ã—Å—Ç—Ä–µ–µ –≤ –∞–≥—Ä–µ–≥–∞—Ü–∏–æ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö
- –û–±–µ –°–£–ë–î –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—Ç –≤—ã—Å–æ–∫—É—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
## üß© –≠—Ç–∞–ø 5: –ê–Ω–∞–ª–∏–∑ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ö–æ–¥ –∞–Ω–∞–ª–∏–∑–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏

```python
import matplotlib.pyplot as plt
import numpy as np
import seaborn as sns
import json
from datetime import datetime

def analyze_complexity():
    """–ê–Ω–∞–ª–∏–∑ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–æ–π —Å–∏—Å—Ç–µ–º—ã"""
    
    print("–ê–ù–ê–õ–ò–ó –°–õ–û–ñ–ù–û–°–¢–ò –†–ï–ê–õ–ò–ó–ê–¶–ò–ò –õ–û–ì–ò–°–¢–ò–ß–ï–°–ö–û–ô –°–ò–°–¢–ï–ú–´")
    print("=" * 60)

    # –ü–æ–¥—Å—á–µ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –ª–æ–≥–∏—Å—Ç–∏–∫–∏
    postgres_join_query = """
SELECT s.tracking_number, s.status, s.weight, s.value,
       wf.name as from_warehouse, wt.name as to_warehouse,
       r.name as route_name
FROM shipments s
JOIN warehouses wf ON s.warehouse_from_id = wf.id
JOIN warehouses wt ON s.warehouse_to_id = wt.id
JOIN routes r ON s.route_id = r.id
WHERE s.status = %s
ORDER BY s.shipment_date DESC
LIMIT 100
""".strip().count('\n') + 1

    postgres_aggregation_query = """
SELECT status, COUNT(*) as count, AVG(weight) as avg_weight, 
       AVG(value) as avg_value, SUM(value) as total_value
FROM shipments 
GROUP BY status
ORDER BY count DESC
""".strip().count('\n') + 1

    # MongoDB –∞–≥—Ä–µ–≥–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø–∞–π–ø–ª–∞–π–Ω—ã
    mongodb_find_steps = 4  # find + projection + sort + limit
    mongodb_aggregation_steps = 5  # $match + $group + $project + $sort + $limit

    print(f"–°–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤:")
    print(f"‚Ä¢ PostgreSQL JOIN –∑–∞–ø—Ä–æ—Å: {postgres_join_query} —Å—Ç—Ä–æ–∫")
    print(f"‚Ä¢ PostgreSQL –∞–≥—Ä–µ–≥–∞—Ü–∏—è: {postgres_aggregation_query} —Å—Ç—Ä–æ–∫")
    print(f"‚Ä¢ MongoDB –ø–æ–∏—Å–∫: {mongodb_find_steps} —ç—Ç–∞–ø–æ–≤")
    print(f"‚Ä¢ MongoDB –∞–≥—Ä–µ–≥–∞—Ü–∏—è: {mongodb_aggregation_steps} —ç—Ç–∞–ø–æ–≤")

    # –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
    plt.style.use('seaborn-v0_8')
    sns.set_palette("husl")

    fig, ((ax1, ax2), (ax3, ax4)) = plt.subplots(2, 2, figsize=(15, 12))

    # –ì—Ä–∞—Ñ–∏–∫ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
    categories = ['JOIN –∑–∞–ø—Ä–æ—Å', '–ê–≥—Ä–µ–≥–∞—Ü–∏—è', '–ü–æ–∏—Å–∫', '–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞']
    postgres_scores = [postgres_join_query, postgres_aggregation_query, 3, 2]
    mongodb_scores = [mongodb_find_steps, mongodb_aggregation_steps, 4, 3]

    x = np.arange(len(categories))
    width = 0.35

    bars1 = ax1.bar(x - width/2, postgres_scores, width, label='PostgreSQL', color='blue', alpha=0.7)
    bars2 = ax1.bar(x + width/2, mongodb_scores, width, label='MongoDB', color='orange', alpha=0.7)
    ax1.set_xlabel('–¢–∏–ø—ã –æ–ø–µ—Ä–∞—Ü–∏–π')
    ax1.set_ylabel('–°–ª–æ–∂–Ω–æ—Å—Ç—å (—Å—Ç—Ä–æ–∫–∏/—ç—Ç–∞–ø—ã)')
    ax1.set_title('–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤')
    ax1.set_xticks(x)
    ax1.set_xticklabels(categories)
    ax1.legend()
    ax1.grid(True, alpha=0.3)

    # –î–æ–±–∞–≤–ª—è–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ —Å—Ç–æ–ª–±—Ü—ã
    for bar in bars1:
        height = bar.get_height()
        ax1.text(bar.get_x() + bar.get_width()/2., height + 0.1,
                 f'{int(height)}', ha='center', va='bottom')
    for bar in bars2:
        height = bar.get_height()
        ax1.text(bar.get_x() + bar.get_width()/2., height + 0.1,
                 f'{int(height)}', ha='center', va='bottom')

    plt.tight_layout()
    plt.savefig('data/complexity_analysis.png', dpi=300, bbox_inches='tight')
    plt.show()

    print(f"\n–ò–¢–û–ì–û–í–´–ï –í–´–í–û–î–´ –î–õ–Ø –õ–û–ì–ò–°–¢–ò–ß–ï–°–ö–û–ô –°–ò–°–¢–ï–ú–´:")
    print(f"=" * 50)
    print(f"PostgreSQL –ª—É—á—à–µ –¥–ª—è –ª–æ–≥–∏—Å—Ç–∏–∫–∏ –∫–æ–≥–¥–∞:")
    print(f"  ‚Ä¢ –¢—Ä–µ–±—É—é—Ç—Å—è —Å–ª–æ–∂–Ω—ã–µ JOIN –º–µ–∂–¥—É –≥—Ä—É–∑–∞–º–∏, —Å–∫–ª–∞–¥–∞–º–∏ –∏ –º–∞—Ä—à—Ä—É—Ç–∞–º–∏")
    print(f"  ‚Ä¢ –ù—É–∂–Ω—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π")
    print(f"  ‚Ä¢ –í–∞–∂–Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏")

    print(f"\nMongoDB –ª—É—á—à–µ –¥–ª—è –ª–æ–≥–∏—Å—Ç–∏–∫–∏ –∫–æ–≥–¥–∞:")
    print(f"  ‚Ä¢ –°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö —á–∞—Å—Ç–æ –º–µ–Ω—è–µ—Ç—Å—è (–Ω–æ–≤—ã–µ —Ç–∏–ø—ã –≥—Ä—É–∑–æ–≤, –∞—Ç—Ä–∏–±—É—Ç—ã)")
    print(f"  ‚Ä¢ –¢—Ä–µ–±—É–µ—Ç—Å—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ")
    print(f"  ‚Ä¢ –î–∞–Ω–Ω—ã–µ –∏–º–µ—é—Ç –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É")

if __name__ == "__main__":
    analyze_complexity()
```
# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –≤—ã–≤–æ–¥—ã

## üìä –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

| –ü–∞—Ä–∞–º–µ—Ç—Ä | PostgreSQL | MongoDB | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|----------|------------|---------|-----------|
| **–†–∞–∑–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö** | 31 –ú–ë | 36 –ú–ë | **PostgreSQL —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ –Ω–∞ 16%** |
| **–ü—Ä–æ—Å—Ç–æ–π –ø–æ–∏—Å–∫** | 0.0591—Å | 0.0309—Å | **MongoDB –±—ã—Å—Ç—Ä–µ–µ –≤ 1.91 —Ä–∞–∑–∞** |
| **–°–ª–æ–∂–Ω—ã–π –ø–æ–∏—Å–∫** | 0.0071—Å | 0.0317—Å | **PostgreSQL –±—ã—Å—Ç—Ä–µ–µ –≤ 4.46 —Ä–∞–∑** |
| **–ê–≥—Ä–µ–≥–∞—Ü–∏—è** | 0.0689—Å | 0.5214—Å | **PostgreSQL –±—ã—Å—Ç—Ä–µ–µ –≤ 7.57 —Ä–∞–∑–∞** |
| **–°–ª–æ–∂–Ω–æ—Å—Ç—å JOIN** | 8 —Å—Ç—Ä–æ–∫ | 4 —ç—Ç–∞–ø–∞ | **MongoDB –ø—Ä–æ—â–µ –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏** |

## üéØ –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã

### üíæ –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ö—Ä–∞–Ω–µ–Ω–∏—è
**PostgreSQL** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–∏—Å–∫–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –Ω–∞ **16% —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–µ–µ** –±–ª–∞–≥–æ–¥–∞—Ä—è –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –¥–∞–Ω–Ω—ã—Ö –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—é –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.

### ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤
- **MongoDB** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ª—É—á—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏—è—Ö **—á—Ç–µ–Ω–∏—è —Å –ø—Ä–æ—Å—Ç—ã–º–∏ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏**
- **PostgreSQL** –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –≤ **–∞–≥—Ä–µ–≥–∞—Ü–∏–æ–Ω–Ω—ã—Ö –∏ —Å–ª–æ–∂–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö**

### üõ†Ô∏è –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
**MongoDB** –ø—Ä–æ—â–µ –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö –±–ª–∞–≥–æ–¥–∞—Ä—è –¥–æ–∫—É–º–µ–Ω—Ç–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏.

### üîÑ –ì–∏–±–∫–æ—Å—Ç—å
**MongoDB** –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±–æ–ª—å—à—É—é –≥–∏–±–∫–æ—Å—Ç—å –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ö–µ–º—ã –¥–∞–Ω–Ω—ã—Ö, –ø–æ–∑–≤–æ–ª—è—è –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –ø–æ–ª—è –±–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–π.

## üìã –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### ‚úÖ –í—ã–±–∏—Ä–∞—Ç—å PostgreSQL –∫–æ–≥–¥–∞:

- **–¢—Ä–µ–±—É—é—Ç—Å—è —Å–ª–æ–∂–Ω—ã–µ JOIN-–æ–ø–µ—Ä–∞—Ü–∏–∏** –º–µ–∂–¥—É —Å–≤—è–∑–∞–Ω–Ω—ã–º–∏ —Å—É—â–Ω–æ—Å—Ç—è–º–∏
- **–í–∞–∂–Ω–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏** –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —Å—Ç–∞–±–∏–ª—å–Ω–∞** –∏ —Ö–æ—Ä–æ—à–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞
- **–¢—Ä–µ–±—É–µ—Ç—Å—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ —Å –∞–≥—Ä–µ–≥–∞—Ü–∏—è–º–∏** –∏ —Å–ª–æ–∂–Ω—ã–º–∏ –æ—Ç—á–µ—Ç–∞–º–∏

### ‚úÖ –í—ã–±–∏—Ä–∞—Ç—å MongoDB –∫–æ–≥–¥–∞:

- **–¢—Ä–µ–±—É–µ—Ç—Å—è –≥–∏–±–∫–∞—è —Å—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö** –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø—Ä–æ—Ç–æ—Ç–∏–ø–∏—Ä–æ–≤–∞–Ω–∏—è
- **–ü—Ä–µ–æ–±–ª–∞–¥–∞—é—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ —á—Ç–µ–Ω–∏—è** —Å –ø—Ä–æ—Å—Ç—ã–º–∏ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
- **–î–∞–Ω–Ω—ã–µ –∏–º–µ—é—Ç –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É** —Å –≤–ª–æ–∂–µ–Ω–Ω—ã–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏
- **–¢—Ä–µ–±—É–µ—Ç—Å—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–ª—è –±–æ–ª—å—à–∏—Ö –Ω–∞–≥—Ä—É–∑–æ–∫

## üöÄ –ò—Ç–æ–≥–æ–≤–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

**–î–ª—è –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∏—Å—Ç–µ–º —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è PostgreSQL** –±–ª–∞–≥–æ–¥–∞—Ä—è:

- –õ—É—á—à–µ–π –ø–æ–¥–¥–µ—Ä–∂–∫–µ —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –º–µ–∂–¥—É –≥—Ä—É–∑–∞–º–∏, —Å–∫–ª–∞–¥–∞–º–∏ –∏ –º–∞—Ä—à—Ä—É—Ç–∞–º–∏
- –ë–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞
- –ù–∞–¥–µ–∂–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç–∏

MongoDB –º–æ–∂–µ—Ç —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å—Å—è –∫–∞–∫ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á, —Ç—Ä–µ–±—É—é—â–∏—Ö –≥–∏–±–∫–æ–π —Å—Ö–µ–º—ã –∏–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ª–æ–≥–∏—Å—Ç–∏–∫–∏.

