# Очистка данных
df_clean = df.copy()

# Удаляем отмененные заказы (где InvoiceNo начинается с 'C')
df_clean = df_clean[~df_clean['InvoiceNo'].astype(str).str.startswith('C', na=False)]

# Удаляем возвраты (отрицательные Quantity)
df_clean = df_clean[df_clean['Quantity'] > 0]

# Удаляем строки с пропущенными Description
df_clean = df_clean[df_clean['Description'].notna()]

# Преобразуем Quantity в числовой формат
df_clean['Quantity'] = pd.to_numeric(df_clean['Quantity'], errors='coerce')
df_clean = df_clean.dropna(subset=['Quantity'])

# Находим топ-10 товаров по количеству продаж
top_10_products = df_clean.groupby('Description')['Quantity'].sum().reset_index()
top_10_products = top_10_products.sort_values('Quantity', ascending=False).head(10)

print("Топ-10 товаров по количеству продаж:")
print(top_10_products.to_string(index=False))

# Дополнительная статистика
print(f"\nОбщая статистика:")
print(f"Всего уникальных товаров: {df_clean['Description'].nunique()}")
print(f"Общее количество проданных единиц: {df_clean['Quantity'].sum():,}")
print(f"Среднее количество продаж на товар: {df_clean.groupby('Description')['Quantity'].sum().mean():.1f}")
